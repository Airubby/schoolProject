(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70ac"],{"0148":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"loncom_content"},[r("div",{staticClass:"loncom_right_content"},[r("div",{staticClass:"bg1C2443 loncom_pd20 loncom_content custom"},[r("div",{staticClass:"search_form_table"},[r("form",{staticClass:"el-form el-form--inline"},[r("el-input",{staticStyle:{width:"250px",margin:"0 5px 10px 0"},attrs:{placeholder:"输入姓名查询",size:"small","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(t){e.keySearch(t)}},model:{value:e.initParams.name,callback:function(t){e.$set(e.initParams,"name",t)},expression:"initParams.name"}}),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.getList,keydown:function(t){e.keySearch(t)}}},[e._v("查询")]),"admin"==e.loginInfo.userid?r("el-button",{staticStyle:{position:"absolute",right:"0",top:"0"},attrs:{type:"primary",size:"small"},on:{click:function(t){e.add()}}},[e._v("新增")]):e._e()],1)]),r("el-scrollbar",{staticStyle:{height:"calc(100% - 45px)"}},[r("el-search-table-pagination",{ref:"thisRef",staticClass:"loncom_position_relative",attrs:{type:"local",border:"",url:e.$ajaxUrl+"/user/query",data:e.table_data,columns:e.table_info_columns,stripe:"","list-field":"data.items","total-field":"data.count",params:e.initParams},on:{"selection-change":e.handleSelectionChange},scopedSlots:e._u([{key:"preview-state",fn:function(t){return[r("div",[e._v("\n                                "+e._s(e._f("stateFilter")(t.row.state))+"\n                            ")])]}},{key:"preview-handle",fn:function(t){return[r("div",["admin"==e.loginInfo.userid?r("p",[r("a",{staticClass:"loncom_color loncom_mr10",attrs:{href:"javascript:;"},on:{click:function(r){e.edit(t.row)}}},[e._v("编辑")]),"admin"!=t.row.userid?r("a",{staticClass:"loncom_color",attrs:{href:"javascript:;"},on:{click:function(r){e.remove(t.row)}}},[e._v("删除")]):e._e()]):e.loginInfo.userid==t.row.userid?r("p",[r("a",{staticClass:"loncom_color",attrs:{href:"javascript:;"},on:{click:function(r){e.edit(t.row)}}},[e._v("编辑")])]):r("p",[e._v("--")])])]}}])},[r("el-table-column",{attrs:{slot:"prepend",type:"selection"},slot:"prepend"}),"admin"==e.loginInfo.userid?r("div",{staticClass:"loncom_table_btn"},[r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.start()}}},[e._v("启用")]),r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){e.assert()}}},[e._v("维护")])],1):e._e()],1)],1)],1)]),e.add_info.visible?r("Add",{attrs:{dialogInfo:e.add_info}}):e._e()],1)},i=[],l=(r("7f7f"),r("cadf"),r("551c"),r("097d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"custom",attrs:{title:e.dialogInfo.title,visible:e.dialogInfo.visible,width:"900px"},on:{"update:visible":function(t){e.$set(e.dialogInfo,"visible",t)}}},[r("el-scrollbar",{staticClass:"loncom_scrollbar",staticStyle:{height:"350px"}},[r("div",{staticClass:"loncom_public_table"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[r("el-row",{attrs:{gutter:40}},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"账号",prop:"userid",size:"small"}},[r("el-input",{attrs:{disabled:e.readonly},model:{value:e.ruleForm.userid,callback:function(t){e.$set(e.ruleForm,"userid",t)},expression:"ruleForm.userid"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"密码",prop:"psword",size:"small"}},[r("el-input",{model:{value:e.ruleForm.psword,callback:function(t){e.$set(e.ruleForm,"psword","string"===typeof t?t.trim():t)},expression:"ruleForm.psword"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"确认密码",prop:"tpassword",size:"small"}},[r("el-input",{attrs:{type:"password"},model:{value:e.ruleForm.tpassword,callback:function(t){e.$set(e.ruleForm,"tpassword","string"===typeof t?t.trim():t)},expression:"ruleForm.tpassword"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"姓名",prop:"name",size:"small"}},[r("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1)],1),"admin"!=e.ruleForm.userid?r("div",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"开始时间",prop:"time_start",size:"small"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",disabled:"admin"!=e.loginInfo.userid,placeholder:"选择日期时间"},model:{value:e.ruleForm.time_start,callback:function(t){e.$set(e.ruleForm,"time_start",t)},expression:"ruleForm.time_start"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"结束时间",prop:"time_end",size:"small"}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetime",disabled:"admin"!=e.loginInfo.userid,placeholder:"选择日期时间"},model:{value:e.ruleForm.time_end,callback:function(t){e.$set(e.ruleForm,"time_end",t)},expression:"ruleForm.time_end"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"管理域",prop:"addrorrole",size:"small"}},[r("el-input",{attrs:{disabled:"admin"!=e.loginInfo.userid},on:{focus:e.selectTree},model:{value:e.ruleForm.addrname,callback:function(t){e.$set(e.ruleForm,"addrname",t)},expression:"ruleForm.addrname"}})],1)],1)],1):e._e(),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"手机",prop:"phone",size:"small"}},[r("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"邮箱",prop:"email",size:"small"}},[r("el-input",{model:{value:e.ruleForm.email,callback:function(t){e.$set(e.ruleForm,"email",t)},expression:"ruleForm.email"}})],1)],1)],1)],1)],1)]),r("dialogBtnInfo",{attrs:{dialogInfobtn:e.dialogInfo},on:{dialogSure:function(t){e.dialogSure()}}}),e.ruleForm.visible?r("tree",{attrs:{dialogInfo:e.ruleForm}}):e._e()],1)}),a=[],n=(r("6b54"),r("1021")),s=r("4360"),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"custom",attrs:{title:"管理域",visible:e.dialogInfo.visible,width:"600px","append-to-body":!0},on:{"update:visible":function(t){e.$set(e.dialogInfo,"visible",t)}}},[r("el-scrollbar",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"loncom_scrollbar",staticStyle:{height:"350px"}},[r("div",{staticClass:"loncom_public_table"},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.formRules,"label-width":"100px"}},[r("el-tree",{ref:"tree",attrs:{"show-checkbox":"","node-key":"id",data:e.treedata,props:{children:"children",label:"name"}},on:{"check-change":e.selsetchangeTree}}),r("el-form-item",{attrs:{prop:"addrorrole"}},[r("el-input",{staticStyle:{display:"none"},attrs:{size:"small"},model:{value:e.ruleForm.addrorrole,callback:function(t){e.$set(e.ruleForm,"addrorrole",t)},expression:"ruleForm.addrorrole"}})],1)],1)],1)]),r("dialogBtnInfo",{attrs:{dialogInfobtn:e.dialogInfo},on:{dialogSure:function(t){e.dialogSure()}}})],1)},u=[],c=(r("28a5"),{created:function(){sessionStorage.loginInfo&&(this.loginInfo=JSON.parse(sessionStorage.loginInfo)),this.getArea()},mounted:function(){},data:function(){return{loading:!1,treedata:[],ruleForm:{addrorrole:"",addrname_list:[]},formRules:{addrorrole:[{required:!0,message:"请选择",trigger:"change"}]}}},methods:{getArea:function(){var e=this;this.loading=!0,this.$api.get("/service/tree",{},function(t){console.log(t),e.loading=!1,"0"==t.err_code&&(e.treedata=t.data,e.$nextTick(function(){this.$refs.tree.setCheckedKeys(this.dialogInfo.addrorrole.split(","))}))})},selsetchangeTree:function(e,t){this.ruleForm.addrname_list=this.$refs.tree.getCheckedNodes(!0),this.ruleForm.addrorrole=this.$refs.tree.getCheckedKeys(!0).toString()},dialogSure:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(t){e.dialogInfo.addrorrole=e.ruleForm.addrorrole;for(var r=[],o=0;o<e.ruleForm.addrname_list.length;o++)r.push(e.ruleForm.addrname_list[o].map.topname+"_"+e.ruleForm.addrname_list[o].name);e.dialogInfo.addrname=r.toString(),e.dialogInfo.visible=!1}})},dialogCancel:function(){this.dialogInfo.visible=!1}},watch:{},components:{dialogBtnInfo:n["a"]},props:["dialogInfo"]}),m=c,p=r("2877"),f=Object(p["a"])(m,d,u,!1,null,null,null);f.options.__file="tree.vue";var g=f.exports,h={created:function(){var e=this;sessionStorage.loginInfo&&(this.loginInfo=JSON.parse(sessionStorage.loginInfo)),this.dialogInfo.id&&(this.readonly=!0,this.$api.get("/user/details",{id:this.dialogInfo.id},function(t){if(console.log(t),"0"==t.err_code){for(var r in e.ruleForm)e.ruleForm[r]=t.data[r];e.ruleForm["psword"]=e.$tool.Decrypt(e.ruleForm["psword"]),e.ruleForm["tpassword"]=e.ruleForm["psword"]}else e.$message.warning(t.err_msg)})),this.getArea()},mounted:function(){},data:function(){var e=this,t=function(t,r,o){e.$tool.checkPHONE({rules:t,value:r,callback:o})},r=function(t,r,o){e.$tool.checkEMAIL({rules:t,value:r,callback:o})},o=function(t,r,o){""===r?o(new Error("请输入密码至少8位且包含数字、字母大小写")):(e.ruleForm.psword&&(/[a-z]/.test(r)&&/[A-Z]/.test(r)&&/[0-9]/.test(r)&&r.length>7?o():o(new Error("请输入密码至少8位且包含数字、字母大小写"))),o())},i=function(t,r,o){""===r?o(new Error("请输入确认密码")):(e.ruleForm.psword!==e.ruleForm.tpassword&&o(new Error("两次密码不一样")),o())},l=function(t,r,o){""===r?o(new Error("请输入账号")):""==e.ruleForm.id?e.$api.get("/user/synuserid",{userid:r},function(e){console.log(e),"0"==e.err_code?o():o(e.err_msg)}):o()},a=function(t,r,o){""===r||null==r?(console.log(r),o(new Error("请输开始时间"))):(e.ruleForm.time_end&&new Date(r).getTime()>=new Date(e.ruleForm.time_end).getTime()&&o(new Error("开始时间应先于结束时间")),o())},n=function(t,r,o){""===r||null==r?o(new Error("请输入结束时间")):(e.ruleForm.time_start&&new Date(r).getTime()<=new Date(e.ruleForm.time_start).getTime()&&o(new Error("结束时间应后于开始时间应")),o())};return{loginInfo:{},readonly:!1,options:[],treedata:[],ruleForm:{id:"",userid:"",psword:"",tpassword:"",name:"",addrorrole:"",addrname:"",time_start:"",time_end:"",phone:"",email:"",roleid:"2",state:"1",visible:!1},rules:{userid:[{required:!0,trigger:"blur",validator:l}],name:[{required:!0,message:"请输入姓名",trigger:"blur"}],psword:[{validator:o,required:!0,trigger:"blur"}],tpassword:[{validator:i,required:!0,trigger:"blur"}],time_start:[{validator:a,required:!0,trigger:"blur"}],time_end:[{validator:n,required:!0,trigger:"blur"}],phone:[{required:!1,trigger:"blur",validator:t}],email:[{required:!1,trigger:"blur",validator:r}]}}},methods:{getArea:function(){var e=this;this.$api.get("/service/tree",{},function(t){console.log(t),"0"==t.err_code&&(e.treedata=t.data)})},selectTree:function(){"admin"==this.loginInfo.userid&&(this.ruleForm.visible=!0)},dialogSure:function(){var e=this;this.$refs["ruleForm"].validate(function(t){if(t){var r=e.ruleForm.id?"/user/update":"/user/add";e.ruleForm.psword=e.$tool.Encrypt(e.ruleForm.psword),e.ruleForm.tpassword=e.$tool.Encrypt(e.ruleForm.tpassword),e.ruleForm.addrorrole=e.ruleForm.addrorrole.toString(),e.$api.post(r,{obj:e.ruleForm},function(t){console.log(t),"0"==t.err_code?(e.$message.success(t.err_msg),e.$parent.getList(),e.ruleForm.id&&s["a"].dispatch("setChangeUser",!0),e.dialogInfo.visible=!1):e.$message.warning(t.err_msg)})}})},dialogCancel:function(){this.dialogInfo.visible=!1}},watch:{},components:{dialogBtnInfo:n["a"],tree:g},props:["dialogInfo"]},v=h,_=Object(p["a"])(v,l,a,!1,null,null,null);_.options.__file="dialogAdd.vue";var b=_.exports,w={created:function(){sessionStorage.loginInfo&&(this.loginInfo=JSON.parse(sessionStorage.loginInfo)),this.getList()},mounted:function(){},data:function(){return{loginInfo:{},options:[],initParams:{name:""},table_info_columns:[{prop:"userid",label:"账号",minWidth:10},{prop:"name",label:"姓名",minWidth:10},{prop:"phone",label:"手机",minWidth:10},{prop:"email",label:"邮箱",minWidth:15},{prop:"time_start",label:"开始时间",minWidth:15},{prop:"time_end",label:"结束时间",minWidth:15},{prop:"addrname",label:"管理域",minWidth:25},{prop:"state",label:"状态",slotName:"preview-state",minWidth:8},{prop:"handel",label:"操作",slotName:"preview-handle",width:100}],table_data:[],add_info:{visible:!1,title:"新增账号",id:""},multipleSelection:[]}},methods:{keySearch:function(e){13==e.keyCode&&this.getList()},handleSelectionChange:function(e){this.multipleSelection=e},add:function(){this.add_info.id="",this.add_info.visible=!0,this.add_info.title="新增账号"},getList:function(){var e=this;this.$api.post("/user/query",{name:this.initParams.name},function(t){console.log(t),"0"==t.err_code?e.table_data=t.data:e.$message.warning(t.err_msg)})},edit:function(e){this.add_info.id=e.id,this.add_info.title="编辑账号",this.add_info.visible=!0},remove:function(e){var t=this;this.$confirm("你确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$api.post("/user/delete",{id:e.id},function(e){"0"==e.err_code?(t.getList(),t.$message.success(e.err_msg)):t.$message.error(e.err_msg)})})},assert:function(e){var t=this,r=[];if(void 0!=e&&void 0!=e.id)r.push(e.id);else{if(!(this.multipleSelection.length>0))return void this.$message.warning("请勾选需要维护的项");for(var o=0;o<this.multipleSelection.length;o++){if("admin"==this.multipleSelection[o].userid)return void this.$message.warning("admin账号不能维护");r.push(this.multipleSelection[o].id)}}this.$confirm("确定维护?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=r.toString();console.log(e),t.$api.post("/user/updatestate",{ids:e,state:"0"},function(e){"0"==e.err_code?(t.$message.success(e.err_msg),t.getList()):t.$message.warning(e.err_msg)})})},start:function(e){var t=this,r=[];if(void 0!=e&&void 0!=e.id)r.push(e.id);else{if(!(this.multipleSelection.length>0))return void this.$message.warning("请勾选需要启用的项");for(var o=0;o<this.multipleSelection.length;o++)r.push(this.multipleSelection[o].id)}this.$confirm("确定启用?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var e=r.toString();console.log(e),t.$api.post("/user/updatestate",{ids:e,state:"1"},function(e){"0"==e.err_code?(t.$message.success(e.err_msg),t.getList()):t.$message.warning(e.err_msg)})})}},watch:{"initParams.name":function(e){""==e&&this.getList()}},props:[],components:{Add:b}},F=w,y=Object(p["a"])(F,o,i,!1,null,null,null);y.options.__file="index.vue";t["default"]=y.exports},1021:function(e,t,r){"use strict";var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:e.dialogCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.dialogSure}},[e._v("保 存")])],1)},i=[],l={created:function(){},mounted:function(){},data:function(){return{}},methods:{dialogSure:function(){this.$emit("dialogSure")},dialogCancel:function(){this.dialogInfobtn.visible=!1}},props:["dialogInfobtn"]},a=l,n=r("2877"),s=Object(n["a"])(a,o,i,!1,null,null,null);s.options.__file="dialogBtnInfo.vue";t["a"]=s.exports}}]);